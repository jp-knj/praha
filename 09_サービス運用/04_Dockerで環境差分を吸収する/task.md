# Dockerでドッカーで環境差分を吸収する
[課題内容](https://airtable.com/appPxhCPFYGqqN9YU/tblVlFr2q4lIqDKYc/viwX8r6DpCRp80swL/recI2RzOBDp8Fbvzz?blocks=hide)

## 課題1（質問）
- Dockerとは何でしょうか？初めてDockerという言葉を聞いた新人エンジニアにも分かるように説明してあげてください
  - 以下の用語を解説してください
    - イメージ
      - `Dockerコンテナ`を構築するために使用するパッケージのことです。イメージには、必要なファイルや設定、およびインストール済みのソフトウェアなどが含まれています。イメージを使用すると、独自の`Dockerコンテナ`を作成し、他のユーザーと共有したり、他のコンテナーから簡単にコピーしたりできます。 
    - コンテナ
      - 独自の仮想環境を構築するための単一のパッケージ化された単位のことです。コンテナは、開発者が作成したアプリケーションのために必要なすべてのファイルを含むイメージを元に作成されます。コンテナーは、仮想マシンよりも効率的に、高い安全性と信頼性。 
    - ベースイメージ
      - 共有イメージのベースの種類です。ベースイメージは、特定のOS、およびそのOS上で実行されるアプリケーションを提供するために使用されます。開発者が独自のアプリケーションを構築するために必要となるすべてのソフトウェアを提供。
    - Dockerレジストリ
      - イメージを保存するための中央リポジトリです。開発者は、レジストリを使用してDockerイメージを取得したり、イメージを他のユーザーと共有したりすることができます。レジストリを使用すると、イメージを簡単に管理および検索することができます。
    - ビルドコンテキスト
      - `Dockerイメージ`を構築するために使用されるディレクトリです。イメージの構築に必要なすべてのファイルを含みます。ビルドコンテキストを使用すると、開発者はイメージを構築して実行可能なものにすることができます。
    - マルチステージビルド
      - 複数のDockerイメージを使用して1つのDockerイメージを構築する手法です。最終的なイメージサイズを縮小し、イメージへの必要なセキュリティアップデートを簡単に行うことができます。
- Q.Dockerfileを作成して環境構築をコード化する事にはどのようなメリットがあるのでしょうか？
- A.環境構築を簡単に記述し、実行可能な形式に変換することができます。すべての変更を追跡でき、環境構築を再現するのが簡単になります。また、Dockerfileを使用すると、イメージをパブリッシュして共有することも容易になります。
- Q.docker-composeはどのような場面で役立ちそうでしょうか？
- A.複数のDockerコンテナーを1つのコマンドで作成および制御することができます。`docker-compose`を使用すると、複数のコンテナーを1つのYAMLファイルで記述し、1つのコマンドで実行できます。また、複数のコンテナーを同時に実行し、複雑なアプリケーションを1つのコマンドで簡単にセットアップすることも可能です。
- Q`.dockerignore`にはどのようなファイルやディレクトリを含めると良いでしょうか？
- A.イメージに含める必要のないファイルやディレクトリを記述します。例えば、イメージにログファイルやテストファイルなどの不要なファイルを含めないようにするため、`Dockerignore`ファイルにそれらを記述することができます。また、`.gitディレクトリ`や`.DS_store`なども`Dockerignore`に含めることをお勧めします。
- パッケージについて 
  - apt-getなどを使って必要なツールを環境にインストールしようと考えた時、Dockerfileの中で以下のように記述するのは問題ありません
    `RUN apt-get update && apt-get install [something]`
    しかし以下のようにRUNコマンドを分割して記述すると問題が生じる（想定していたバージョンがインストールされない）可能性があります
    ```
    RUN apt-get update
    RUN apt-get install [something]
    ```
    Q.何故でしょうか？
    - RUNコマンドを分割して記述すると、`Docker`はコンテナ内の状態（イメージ）をキャッシュします。そのため、`apt-get update`コマンドを実行してから`apt-get install`コマンドを実行すると、インストール前に更新された新しいバージョンがインストールされてしまいます。
- ENVについて 
  - Q.`ENV NAME='hoge'`と記載しても、`RUN export NAME='hoge'`と記載しても、どちらの方法でも環境変数を設定できますが、この2つの設定方法には大きな違いがあります。それはなんでしょうか？
    - A.ENVコマンドを使用すると、コンテナのイメージに環境変数を設定することができます。つまり、イメージを作成した状態から環境変数を使用することが可能となります。一方で、RUNコマンドを使用すると、コンテナを起動した状態で環境変数を設定することができます。つまり、コンテナを作成した後でイメージから環境変数を使用することが可能となります。


課題2（実装）

「特大課題」で作成したプラハチャレンジのアプリケーションをDocker化してみましょう
docker run && docker startすればアプリケーションが立ち上がるようなDockerfileを作成してください
完成したらコンテナを立ち上げてcurlなどでリクエストを送り、正しくレスポンスが返されることを確認してください
上記Dockerfileを元にアプリケーションがdocker-composeで立ち上がるよう、docker-compose.ymlファイルを作成してください
完成したらコンテナを立ち上げてcurlなどでリクエストを送り、正しくレスポンスが返されることを確認してください